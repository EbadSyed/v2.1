name=OTA Bootload Server
description=OTA Bootload server functionality.
category=ZCL
quality=development

providedApis=zcl-ota-bootload-server

requiredApis=stack,zcl-core,zcl-ota-bootload-core,zcl-ota-bootload-storage-core

ota-bootload-server.c

implementedCallbacks=emberZclClusterOtaBootloadServerCommandQueryNextImageRequestHandler,emberZclClusterOtaBootloadServerCommandUpgradeEndRequestHandler

callbacks=callback.info

options=imageNotifyPeriodMinutes

# The upperbound of this range was obtained through the EMBER_MAX_EVENT_CONTROL_DELAY_MINUTES symbol in stack/include/event.h.
imageNotifyPeriodMinutes.name=Image Notify Period (Minutes)
imageNotifyPeriodMinutes.description=How often a server will broadcast an image notify command conveying that there is a new OTA file that can be downloaded.
imageNotifyPeriodMinutes.type=NUMBER:0,3200
imageNotifyPeriodMinutes.default=60

setup(bookkeeping) {
  networkStatus=emZclOtaBootloadServerNetworkStatusCallback
}

# This is a fake upgrade URI used for downloading images until we figure out how we want to obtain this URI. See also ota-bootload-core.h.
setup(coapDispatch) {
  GET, ota/, emZclOtaBootloadServerDownloadHandler
}


setup(eventConfiguration) {
  emZclOtaBootloadServerImageNotifyEventControl, emZclOtaBootloadServerImageNotifyEventHandler
}

setup(zclip) {
  provides: ota-bootload,server
}
